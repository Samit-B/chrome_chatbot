<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Assistant</title>
    <link href="styles.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon/fonts/remixicon.css">
    <script src="browser-polyfill.js"></script>
    <script src="popup.js" type="module"></script>
    <style>
        /* Firefox sidebar specific styles */
        @-moz-document url-prefix() {
            :root {
                --sidebar-width: 400px;
            }

            body {
                width: var(--sidebar-width);
                max-width: var(--sidebar-width);
                min-width: var(--sidebar-width);
                height: 100vh;
                overflow-x: hidden;
            }

            .container {
                width: var(--sidebar-width);
                height: 100vh;
            }

            /* Adjust content area spacing */
            .flex-1.flex.flex-col.p-4 {
                padding: 0.75rem;
                width: var(--sidebar-width);
            }

            /* Make text inputs and buttons fit */
            textarea,
            input,
            button {
                max-width: calc(var(--sidebar-width) - 20px);
            }

            /* Adjust grid columns for better fit */
            .grid-cols-4 {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.5rem;
            }
        }
        @keyframes waveAnimation {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.2);
                opacity: 0.6;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .speaking {
            animation: waveAnimation 0.8s infinite;
        }

        #speechToText {
            transition: all 0.3s ease-in-out;
        }

        #speechToText.listening {
            animation: waveAnimation 1s ease-in-out infinite;
            background-color: #60a5fa !important;
            color: white !important;
            width: 120px !important;
            border-radius: 50px;
        }
    </style>
</head>

<body class="bg-surface-50 dark:bg-dark-surface-50 w-full h-screen overflow-hidden flex flex-col">
    <div class="h-full flex flex-col">
        <!-- Header -->
        <div
            class="sticky top-0 bg-white/90 dark:bg-dark-surface-100/90 backdrop-blur-md border-b border-surface-200 dark:border-dark-surface-200 px-4 py-1 flex justify-between items-center">
            <div class="flex items-center gap-1 p-0 bg-blue-50 rounded-lg shadow-md">
                <div class="">
                    <h1 class="text-xl font-bold text-blue-800">Ask Algo!</h1>
                </div>
                
            </div>
            <button id="toggleSettings"
                class="button quick px-4 py-1 border-2 border-blue-500 text-blue-500 bg-white rounded-full flex items-center justify-center gap-2 transition-all hover:border-orange-500 hover:text-orange-500 hover:bg-orange-100 min-w-[10px] whitespace-nowrap">
                <i class="bi bi-gear-wide-connected"></i>
            </button>
        </div>

        <!-- Settings Panel -->
        <div id="settingsPanel"
            class="hidden fixed inset-0 z-[9999] bg-surface-50/95 dark:bg-dark-surface-50/95 p-4 overflow-y-auto">
            <div
                class="bg-white dark:bg-dark-surface-100 rounded-xl border border-surface-200 dark:border-dark-surface-200 p-4 shadow-soft max-w-md mx-auto">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-lg font-semibold text-surface-900 dark:text-dark-surface-900">Settings</h2>
                    <button id="closeSettings"
                        class="text-surface-500 hover:text-surface-700 dark:text-dark-surface-500 dark:hover:text-dark-surface-700">
                        <i class="ri-close-line text-xl"></i>
                    </button>
                </div>

                <div class="space-y-3">
                    <!-- API Settings Group -->
                    <div class="space-y-2">
                        <label class="block">
                            <span class="text-xs font-medium text-surface-700 dark:text-dark-surface-700">API
                                Type</span>
                            <select id="apiType"
                                class="mt-1 w-full h-8 px-2 text-sm rounded-md border-surface-200 dark:border-dark-surface-200 bg-white dark:bg-dark-surface-100 text-surface-900 dark:text-dark-surface-900 focus:border-primary-500 focus:ring-1 focus:ring-primary-500">
                                <option value="custom">Custom API</option>
                                <option value="huggingface">Hugging Face</option>
                            </select>
                        </label>

                        <div id="customApiSection">
                            <label class="block">
                                <span class="text-xs font-medium text-surface-700 dark:text-dark-surface-700">API
                                    URL</span>
                                <input type="text" id="apiUrl"
                                    class="mt-1 w-full h-8 px-2 text-sm rounded-md border-surface-200 dark:border-dark-surface-200 bg-white dark:bg-dark-surface-100 text-surface-900 dark:text-dark-surface-900 focus:border-primary-500 focus:ring-1 focus:ring-primary-500"
                                    placeholder="http://localhost:8000">
                            </label>
                        </div>

                        <label class="block">
                            <span class="text-xs font-medium text-surface-700 dark:text-dark-surface-700">API
                                Token</span>
                            <div class="relative">
                                <input type="password" id="apiToken"
                                    class="mt-1 w-full h-8 px-2 text-sm rounded-md border-surface-200 dark:border-dark-surface-200 bg-white dark:bg-dark-surface-100 text-surface-900 dark:text-dark-surface-900 focus:border-primary-500 focus:ring-1 focus:ring-primary-500"
                                    placeholder="Your API token">
                                <button id="toggleToken"
                                    class="absolute right-2 top-1/2 -translate-y-1/2 text-surface-400 hover:text-surface-600">
                                    <i class="ri-eye-line"></i>
                                </button>
                            </div>
                        </label>
                    </div>

                    <!-- Model Settings Group -->
                    <div class="space-y-2">
                        <label class="block">
                            <span class="text-xs font-medium text-surface-700 dark:text-dark-surface-700">Model
                                Name</span>
                            <input type="text" id="modelName"
                                class="mt-1 w-full h-8 px-2 text-sm rounded-md border-surface-200 dark:border-dark-surface-200 bg-white dark:bg-dark-surface-100 text-surface-900 dark:text-dark-surface-900 focus:border-primary-500 focus:ring-1 focus:ring-primary-500"
                                placeholder="meta-llama/Llama-2-7b-chat">
                        </label>

                        <div class="grid grid-cols-2 gap-3">
                            <label class="block">
                                <span class="text-xs font-medium text-surface-700 dark:text-dark-surface-700">Max
                                    Tokens</span>
                                <input type="number" id="maxTokens"
                                    class="mt-1 w-full h-8 px-2 text-sm rounded-md border-surface-200 dark:border-dark-surface-200 bg-white dark:bg-dark-surface-100 text-surface-900 dark:text-dark-surface-900 focus:border-primary-500 focus:ring-1 focus:ring-primary-500"
                                    min="1" max="2048" placeholder="500">
                            </label>

                            <label class="block">
                                <span
                                    class="text-xs font-medium text-surface-700 dark:text-dark-surface-700">Theme</span>
                                <select id="theme"
                                    class="mt-1 w-full h-8 px-2 text-sm rounded-md border-surface-200 dark:border-dark-surface-200 bg-white dark:bg-dark-surface-100 text-surface-900 dark:text-dark-surface-900 focus:border-primary-500 focus:ring-1 focus:ring-primary-500">
                                    <option value="light">Light</option>
                                    <option value="dark">Dark</option>
                                    <option value="system">System</option>
                                </select>
                            </label>
                        </div>
                    </div>

                    <!-- Prompt Settings Group -->
                    <div class="space-y-2">
                        <h3 class="text-xs font-medium text-surface-700 dark:text-dark-surface-700">Quick Action Prompts
                        </h3>
                        <label class="block">
                            <span class="text-xs font-medium text-surface-700 dark:text-dark-surface-700">Proofread
                                Prompt</span>
                            <input type="text" id="proofreadPrompt"
                                class="mt-1 w-full h-8 px-2 text-sm rounded-md border-surface-200 dark:border-dark-surface-200 bg-white dark:bg-dark-surface-100 text-surface-900 dark:text-dark-surface-900 focus:border-primary-500 focus:ring-1 focus:ring-primary-500">
                        </label>
                        <label class="block">
                            <span class="text-xs font-medium text-surface-700 dark:text-dark-surface-700">Summarize
                                Prompt</span>
                            <input type="text" id="summarizePrompt"
                                class="mt-1 w-full h-8 px-2 text-sm rounded-md border-surface-200 dark:border-dark-surface-200 bg-white dark:bg-dark-surface-100 text-surface-900 dark:text-dark-surface-900 focus:border-primary-500 focus:ring-1 focus:ring-primary-500">
                        </label>
                        <label class="block">
                            <span class="text-xs font-medium text-surface-700 dark:text-dark-surface-700">Rewrite
                                Prompt</span>
                            <input type="text" id="rewritePrompt"
                                class="mt-1 w-full h-8 px-2 text-sm rounded-md border-surface-200 dark:border-dark-surface-200 bg-white dark:bg-dark-surface-100 text-surface-900 dark:text-dark-surface-900 focus:border-primary-500 focus:ring-1 focus:ring-primary-500">
                        </label>
                        <label class="block">
                            <span class="text-xs font-medium text-surface-700 dark:text-dark-surface-700">List
                                Prompt</span>
                            <input type="text" id="makeListPrompt"
                                class="mt-1 w-full h-8 px-2 text-sm rounded-md border-surface-200 dark:border-dark-surface-200 bg-white dark:bg-dark-surface-100 text-surface-900 dark:text-dark-surface-900 focus:border-primary-500 focus:ring-1 focus:ring-primary-500">
                        </label>
                    </div>
                </div>

                <div
                    class="mt-4 flex items-center justify-between pt-3 border-t border-surface-200 dark:border-dark-surface-200">
                    <span id="saveMessage" class="text-xs text-surface-600 dark:text-dark-surface-600 hidden"></span>
                    <button id="saveSettings"
                        class="px-4 py-1.5 text-sm bg-primary-600 hover:bg-primary-700 text-white rounded-lg transition-colors">
                        Save Changes
                    </button>
                </div>
            </div>
        </div>

        <div class="flex-1 flex flex-col p-4 space-y-4 min-h-0">
            <!-- Context Section -->
            <div class="space-y-1.5" style="display: none;">
                <h2 class="text-sm font-medium text-surface-700 dark:text-dark-surface-700">Context</h2>
                <textarea id="content"
                    class="w-full h-20 p-1 text-xs rounded-lg border border-surface-200/75 dark:border-dark-surface-200/75 bg-white/50 dark:bg-dark-surface-100/50 focus:bg-white dark:focus:bg-dark-surface-100 shadow-sm hover:shadow focus:border-primary-500 focus:ring-primary-500 resize-none transition-all overflow-y-auto dark:text-dark-surface-900"
                    placeholder="Paste or type text here, or wait for page content to load..."></textarea>
            </div>

            <!-- Quick Actions -->
            <div class="grid grid-cols-3 gap-2" style="display: none;">
                <button
                    class="button quick px-4 py-2 border-2 border-blue-500 text-blue-500 bg-white rounded-full flex items-center justify-center gap-2 transition-all hover:border-orange-500 hover:text-orange-500 hover:bg-orange-100 min-w-[100px] whitespace-nowrap"
                    data-action="proofread">
                    <i class="ri-check-line text-sm shrink-0"></i>
                    <span class="truncate">Proofread</span>
                </button>

                <button
                    class="button quick px-4 py-2 border-2 border-blue-500 text-blue-500 bg-white rounded-full flex items-center justify-center gap-2 transition-all hover:border-orange-500 hover:text-orange-500 hover:bg-orange-100 min-w-[100px] whitespace-nowrap"
                    data-action="summarize">
                    <i class="bi bi-filter-circle-fill"></i>
                    <span class="truncate">Summarize</span>
                </button>

                <button
                    class="button quick px-4 py-2 border-2 border-blue-500 text-blue-500 bg-white rounded-full flex items-center justify-center gap-2 transition-all hover:border-orange-500 hover:text-orange-500 hover:bg-orange-100 min-w-[100px] whitespace-nowrap"
                    data-action="rewrite">
                    <i class="ri-pen-nib-line text-sm shrink-0"></i>
                    <span class="truncate">Rewrite</span>
                </button>
                <button
                    class="button quick px-4 py-2 border-2 border-blue-500 text-blue-500 bg-white rounded-full flex items-center justify-center gap-2 transition-all hover:border-orange-500 hover:text-orange-500 hover:bg-orange-100 min-w-[100px] whitespace-nowrap"
                    data-action="makeList">
                    <i class="ri-list-check text-sm shrink-0"></i>
                    <span class="truncate">List</span>
                </button>
                <button
                    class="button quick px-4 py-2 border-2 border-blue-500 text-blue-500 bg-white rounded-full flex items-center justify-center gap-2 transition-all hover:border-orange-500 hover:text-orange-500 hover:bg-orange-100 min-w-[100px] whitespace-nowrap"
                    data-action="exportToPdf">
                    <i class="bi bi-file-earmark-pdf"></i>
                    <span class="truncate">Export To Pdf</span>
                </button>
            </div>

            <!-- Response Section -->
            <div class="flex flex-col h-full">
                <div id="response"
                    class="bg-white dark:bg-dark-surface-100 border border-orange-500 p-3 overflow-y-auto shadow-sm rounded-lg flex flex-col gap-2 flex-grow"
                    style="max-height: 80vh; min-height: 150px;">
                    
                    <!-- Messages will be appended here -->
                    <div id="responseContent" class="flex flex-col gap-2"></div>
                </div>
            </div>

          

        </div>
    </div>
</body>

</html>